# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –∏–∑ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—è

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—é—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä–µ–º:
- **–ò–º–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –∏–∑ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—è –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏—Ö –≤ –±–æ—Ç–∞
- **–≠–∫—Å–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä–µ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

### –ò–º–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π (–∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –±–æ—Ç–∞)

1. **–†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ–π—á–∞—Å" –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—è
2. **–î–∏–∞–ø–∞–∑–æ–Ω —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**: 
   - –°–æ–±—ã—Ç–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π
   - –°–æ–±—ã—Ç–∏—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ 90 –¥–Ω–µ–π
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**: 
   - –°–æ–±—ã—Ç–∏—è –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø–æ `yandexEventId` (UID –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è)
   - –ï—Å–ª–∏ —Å–æ–±—ã—Ç–∏–µ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –±–æ—Ç–µ, –æ–Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
4. **–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö**:
   - –ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
   - –û–ø–∏—Å–∞–Ω–∏–µ
   - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞
   - –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ)

### –≠–∫—Å–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π (–∏–∑ –±–æ—Ç–∞ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å)

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞ (`/add_event` –∏–ª–∏ —á–µ—Ä–µ–∑ –º–µ–Ω—é), —Å–æ–±—ã—Ç–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å, –µ—Å–ª–∏:
- ‚úÖ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–¥–∫–ª—é—á–µ–Ω
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞ (`syncEnabled: true`)

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—ã —É–≤–∏–¥–∏—Ç–µ:
- üì• **–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π
- ‚è≠Ô∏è **–ü—Ä–æ–ø—É—â–µ–Ω–æ**: –°–æ–±—ã—Ç–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –±—ã–ª–∏ –≤ –±–æ—Ç–µ
- üìÖ **–í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ**: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–í —Ç–∞–±–ª–∏—Ü–µ `events` –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ:
- `yandexEventId` (String, nullable) - UID —Å–æ–±—ã—Ç–∏—è –∏–∑ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—è

–≠—Ç–æ –ø–æ–ª–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –°–≤—è–∑–∏ —Å–æ–±—ã—Ç–∏–π –º–µ–∂–¥—É –±–æ—Ç–æ–º –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º

### –ú–µ—Ç–æ–¥—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**`YandexCalendarService.getEvents(startDate, endDate)`**
- –ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è —á–µ—Ä–µ–∑ CalDAV REPORT –∑–∞–ø—Ä–æ—Å
- –ü–∞—Ä—Å–∏—Ç iCal —Ñ–æ—Ä–º–∞—Ç –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏–π
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏–∑ VALARM –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**`store.upsertEvent(maxUserId, payload)`**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –ø–æ `yandexEventId`
- –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Å–æ–±—ã—Ç–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ —É–∂–µ –µ—Å—Ç—å

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **403 Forbidden –Ω–∞ REPORT –∑–∞–ø—Ä–æ—Å–∞—Ö**: 
   - –ù–µ–∫–æ—Ç–æ—Ä—ã–µ CalDAV —Å–µ—Ä–≤–µ—Ä—ã –º–æ–≥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 403 –Ω–∞ REPORT –∑–∞–ø—Ä–æ—Å–∞—Ö
   - –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –±–æ—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
   - –°–æ–±—ã—Ç–∏—è —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è

2. **–û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π**:
   - –ï—Å–ª–∏ —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–æ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ, –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - –ù—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä–æ–µ —Å–æ–±—ã—Ç–∏–µ –≤ –±–æ—Ç–µ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–Ω–æ–≤–æ

3. **–£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π**:
   - –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –≤ –±–æ—Ç–µ –Ω–µ —É–¥–∞–ª—è–µ—Ç –µ–≥–æ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
   - –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –Ω–µ —É–¥–∞–ª—è–µ—Ç –µ–≥–æ –∏–∑ –±–æ—Ç–∞ (–Ω—É–∂–Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞: `/settings` –∏–ª–∏ —á–µ—Ä–µ–∑ –º–µ–Ω—é
2. –ù–∞–∂–º–∏—Ç–µ "üìÖ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å"
3. –ù–∞–∂–º–∏—Ç–µ "üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ–π—á–∞—Å"
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑ –≤ —á–∞—Å).

## üìù –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é:

```bash
# –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
npx prisma migrate dev --name add_yandex_event_id

# –ò–ª–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é
npx prisma migrate deploy
```

–ú–∏–≥—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç:
- –ü–æ–ª–µ `yandexEventId` –≤ —Ç–∞–±–ª–∏—Ü—É `events`
- –ò–Ω–¥–µ–∫—Å –Ω–∞ `yandexEventId` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞

