# üìÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç —Å–æ–±—ã—Ç–∏–π

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –≤–∫–ª—é—á–µ–Ω `dailyDigest` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.

### –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: **09:00** –ø–æ —á–∞—Å–æ–≤–æ–º—É –ø–æ—è—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ `UserSettings.timezone`)

### –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è

1. **–ó–∞–¥–∞—á–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è** - –∑–∞–¥–∞—á–∏ —Å –¥–µ–¥–ª–∞–π–Ω–æ–º –Ω–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å
2. **–°–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è** - –≤—Å–µ —Å–æ–±—ã—Ç–∏—è, –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å (—Å 00:00 –¥–æ 23:59)

### –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

```
üìÖ –î–∞–π–¥–∂–µ—Å—Ç –Ω–∞ 14 –Ω–æ—è–±—Ä—è 2024

üìã –ó–∞–¥–∞—á–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (2):
‚Ä¢ –°–¥–µ–ª–∞—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é ‚Äî –¥–æ 18:00
‚Ä¢ –í—Å—Ç—Ä–µ—á–∞ —Å –∫–æ–º–∞–Ω–¥–æ–π ‚Äî –¥–æ 14:00

üìÜ –°–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (3):
‚Ä¢ 10:00 ‚Äî –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º
  –û–±—Å—É–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
‚Ä¢ 14:30 ‚Äî –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è
‚Ä¢ 18:00 ‚Äî –°–ø–æ—Ä—Ç–∑–∞–ª
```

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –§–∞–π–ª: `bot/src/notifications.js`

```javascript
async sendDailySummary(userId) {
  // –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  const settings = await this.store.getSettings(userId);
  
  // –ü–æ–ª—É—á–∞–µ–º –∑–∞–¥–∞—á–∏ –∏ —Å–æ–±—ã—Ç–∏—è
  const tasks = await this.store.getTasks(userId);
  const events = await this.store.getEvents(userId);
  
  // –§–∏–ª—å—Ç—Ä—É–µ–º —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (00:00 - 23:59)
  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
  const tomorrow = new Date(today);
  tomorrow.setDate(tomorrow.getDate() + 1);
  
  const todayEvents = events.filter((event) => {
    const eventDate = new Date(event.datetime);
    return eventDate >= today && eventDate < tomorrow;
  });
  
  // –§–æ—Ä–º–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
  // ...
}
```

### –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `node-schedule`:

```javascript
schedule.scheduleJob(
  { rule: '0 9 * * *', tz: settings.timezone },
  async () => await this.sendDailySummary(userId)
);
```

- `'0 9 * * *'` - –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 09:00
- `tz: settings.timezone` - —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –¥–∞–π–¥–∂–µ—Å—Ç

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞:
- –ö–æ–º–∞–Ω–¥–∞ `/menu` ‚Üí ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí üîî –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –¥–∞–π–¥–∂–µ—Å—Ç

### –ò–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏

‚úÖ **–£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ!** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

1. –û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: `/menu` ‚Üí ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
2. –ù–∞–∂–∞—Ç—å "‚è∞ –ò–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è –¥–∞–π–¥–∂–µ—Å—Ç–∞"
3. –í–≤–µ—Å—Ç–∏ –≤—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ `–ß–ß:–ú–ú` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `08:00` –∏–ª–∏ `18:30`)

–í—Ä–µ–º—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–æ–ª–µ `dailyDigestTime` –≤ —Ç–∞–±–ª–∏—Ü–µ `user_settings`.

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [DIGEST_TIME_SETTING.md](./DIGEST_TIME_SETTING.md).

### –ò–∑–º–µ–Ω–∏—Ç—å —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- –ö–æ–º–∞–Ω–¥–∞ `/menu` ‚Üí ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –°–º–µ–Ω–∏—Ç—å —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å

## –£–ª—É—á—à–µ–Ω–∏—è

### –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

1. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Pomodoro –∑–∞ –¥–µ–Ω—å** –≤ –¥–∞–π–¥–∂–µ—Å—Ç
2. **–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –∑–∞–¥–∞—á–∞—Ö** —Å –¥–µ–¥–ª–∞–π–Ω–æ–º —Å–µ–≥–æ–¥–Ω—è
3. **–ú–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** –µ—Å–ª–∏ –Ω–µ—Ç –∑–∞–¥–∞—á/—Å–æ–±—ã—Ç–∏–π
4. **–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –∑–∞–≤—Ç—Ä–∞** - —á—Ç–æ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å

### –ü—Ä–∏–º–µ—Ä —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –¥–∞–π–¥–∂–µ—Å—Ç–∞:

```
üìÖ –î–∞–π–¥–∂–µ—Å—Ç –Ω–∞ 14 –Ω–æ—è–±—Ä—è 2024

üìã –ó–∞–¥–∞—á–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (2):
‚Ä¢ –°–¥–µ–ª–∞—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é ‚Äî –¥–æ 18:00
‚Ä¢ –í—Å—Ç—Ä–µ—á–∞ —Å –∫–æ–º–∞–Ω–¥–æ–π ‚Äî –¥–æ 14:00

üìÜ –°–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (3):
‚Ä¢ 10:00 ‚Äî –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º
‚Ä¢ 14:30 ‚Äî –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è
‚Ä¢ 18:00 ‚Äî –°–ø–æ—Ä—Ç–∑–∞–ª

üçÖ Pomodoro —Å–µ–≥–æ–¥–Ω—è:
‚Ä¢ –ó–∞–≤–µ—Ä—à–µ–Ω–æ —Å–µ—Å—Å–∏–π: 3
‚Ä¢ –í—Å–µ–≥–æ —Ü–∏–∫–ª–æ–≤: 12
‚Ä¢ –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: 5 —á–∞—Å–æ–≤

üí™ –û—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏!
```

